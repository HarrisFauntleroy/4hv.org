<div class="custom-card">
  <div class="card-header">
    <div class="header-content">
      <%= image_tag("bullet.png") %>
      <span><%= t("forums") %></span>
    </div>
  </div>
  <div class="card-body">
    <% @category_groups.each do |category_group| %>
      <table class="nforumholder">
        <tbody>
          <tr>
            <td colspan="6" class="nforumcaption">
              <%= category_group.name %>
            </td>
          </tr>
          <tr>
            <td colspan="2" style="width:60%; text-align:center" class="nforumcaption2">Forums</td>
            <td style="width:10%; text-align:center" class="nforumcaption2"><%= t("topics") %></td>
            <td style="width:10%; text-align:center" class="nforumcaption2"><%= t("replies") %></td>
            <td style="width:20%; text-align:center" class="nforumcaption2"><%= t("last_comment") %></td>
            <% if current_user&.admin? %>
              <td style="width:20%; text-align:center" class="nforumcaption2"><%= t("actions") %></td>
            <% end %>
          </tr>
          <% category_group.forums.each do |forum| %>
            <tr>
              <td style="width:5%; text-align:center" class="nforumcaption3">
                <%= image_tag("nonew.png") %>
              </td>
              <td class="nforumcaption3">
                <%= link_to forum.name, [category_group, forum], class: "category-title" %>
                <br/>
                <span class="smallblacktext">
                  <%= forum.description %>
                </span>
              </td>
              <td style="width: 10%; text-align: center;" class="nforumthread">
                <%= forum.total_topics %>
              </td>
              <td style="width: 10%; text-align: center;" class="nforumthread">
                <%= forum.total_comments %>
              </td>
              <td style="width: 20%; text-align: center;" class="nforumthread">
                <span class="smallblacktext">
                  <% if forum.last_comment_info %>
                    <%= link_to forum.last_comment_info,
                    forum_topic_path(
                      forum,
                      forum.topics.last,
                      forum.topics.last.comments.last,
                      anchor: "comment-#{forum.topics.last.comments.last.id}",
                    ) %>
                  <% else %>
                    <%= t("no_comments_yet") %>
                  <% end %>
                </span>
              </td>
              <% if current_user&.admin? %>
                <td style="width: 20%; text-align: center;" class="nforumthread">
                  <div class="btn-group">
                    <% if policy(forum).edit? %>
                      <%= link_to t("edit"), edit_forum_path(forum), class: "btn" %>
                    <% end %>
                    <% if policy(forum).destroy? %>
                      <%= button_to t("delete"),
                      forum,
                      class: "btn",
                      method: :delete,
                      data: {
                        confirm: t("are_you_sure"),
                        turbo_confirm: t("are_you_sure"),
                      } %>
                    <% end %>
                  </div>
                </td>
              <% end %>
            </tr>
          <% end %>
        </tbody>
        <tfoot class="category-footer">
          <div>
            <% if policy(category_group).destroy? %>
              <%= button_to t("delete"),
              category_group,
              class: "btn",
              method: :delete,
              data: {
                confirm: t("are_you_sure"),
                turbo_confirm: t("are_you_sure"),
              } %>
            <% end %>
          </div>
        </tfoot>
      </table>
    <% end %>
  </div>
  <div class="btn-group">
    <% if current_user&.admin? %>
      <%= link_to t("new_category_group"), new_category_group_path, class: "btn" %>
      <%= link_to t("new_forum"), new_forum_path, class: "btn" %>
    <% end %>
  </div>
</div>
